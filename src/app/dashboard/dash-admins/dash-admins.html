<main class="py-5">
  <div class="container">
    <h1>Add New Admin</h1>
    <form [formGroup]="adminForm" (ngSubmit)="addAdmin()">
      <div class="mb-3">
        <label for="username" class="form-label">Username</label>
        <input type="text" class="form-control" id="username" formControlName="name" />
        @if(adminForm.get('name')?.invalid && adminForm.get('name')?.touched) {
        <div class="msg">
          <span *ngIf="adminForm.get('name')?.errors?.['required']">Name is required</span>
        </div>
        }
      </div>
      <div class="mb-3">
        <label for="registerEmail" class="form-label">Email address</label>
        <input
          type="email"
          class="form-control"
          id="registerEmail"
          aria-describedby="emailHelp"
          placeholder="example@example.com"
          formControlName="email"
        />
        @if(adminForm.get('email')?.invalid && adminForm.get('email')?.touched) {
        <div class="msg">
          <span *ngIf="adminForm.get('email')?.errors?.['required']">Email is required</span>
          <span *ngIf="adminForm.get('email')?.errors?.['pattern']"
            >Please enter a valid email</span
          >
        </div>
        }
      </div>
      <div class="mb-3">
        <label for="registerPassword" class="form-label">Password</label>
        <input
          type="password"
          class="form-control"
          id="registerPassword"
          formControlName="password"
        />
        @if(adminForm.get('password')?.invalid && adminForm.get('password')?.touched) {
        <div class="msg">
          <span *ngIf="adminForm.get('password')?.errors?.['required']">Password is required</span>
          <span *ngIf="adminForm.get('password')?.errors?.['pattern']"
            >Please enter a strong password<br />* min-length 8 characters<br />* one uppercase
            letter<br />* one lowercase letter<br />* one number</span
          >
        </div>
        }
      </div>
      <div class="mb-3">
        <label for="confirmPassword" class="form-label">Confirm Password</label>
        <input
          type="password"
          class="form-control"
          id="confirmPassword"
          formControlName="confirmPassword"
        />
        @if(adminForm.get('confirmPassword')?.invalid && adminForm.get('confirmPassword')?.touched)
        {
        <div class="msg">
          <div *ngIf="adminForm.get('confirmPassword')?.errors?.['required']">
            Confirm Password is required
          </div>
          <div *ngIf="adminForm.get('confirmPassword')?.errors?.['dismatchpassword']">
            The password and the confirm doesn't match
          </div>
        </div>
        }
      </div>
      <div class="d-flex justify-content-end">
        <button class="btn btn-success">Add Admin</button>
      </div>
    </form>
    <h1>Your Admins List</h1>
    @for (admin of adminsList(); track admin._id) {
    <div class="card mb-3">
      <div class="card-body position-relative">
        <div
          class="d-flex align-items-center gap-2 position-absolute end-0"
          style="z-index: 5; margin-right: 1rem"
        >
          <button
            type="button"
            class="btn btn-danger"
            (click)="setTarget(admin)"
            data-bs-toggle="modal"
            data-bs-target="#deleteAdminModal"
          >
            <i class="fa-solid fa-trash-can"></i>
          </button>
        </div>
        <div>
          <p>Name: {{ admin.name }}</p>
          <p>Email: {{ admin.email }}</p>
        </div>
      </div>
    </div>
    }
  </div>
</main>
<!-- Modal -->
<!-- DELETE -->
<div
  class="modal fade"
  id="deleteAdminModal"
  tabindex="-1"
  aria-labelledby="deleteAdminModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="deleteAdminModalLabel">Confirm Delete</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h4>Are You Sure You Want To Delete {{ targetAdmin().name }}</h4>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button
          type="button"
          class="btn btn-danger"
          data-bs-dismiss="modal"
          (click)="confirmDelete()"
        >
          Confirm Delete
        </button>
      </div>
    </div>
  </div>
</div>
<!-- ALERTS -->
<div
  class="alert alert-success alert-dismissible position-fixed end-0"
  role="alert"
  style="width: fit-content; bottom: 45px; z-index: 5"
  *ngIf="isSuccess()"
>
  <div>{{ alertMessage() }}</div>
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
<div
  class="alert alert-danger alert-dismissible position-fixed end-0"
  role="alert"
  style="width: fit-content; bottom: 45px; z-index: 5"
  *ngIf="isError()"
>
  <div>{{ alertMessage() }}</div>
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
